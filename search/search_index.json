{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"","title":"Home"},{"location":"blog/","text":"","title":"Index"},{"location":"blog/2022/creating-my-home-lab/","text":"","title":"Creating my home lab"},{"location":"cluster/","text":"Home Cluster \u00b6 Building and deploying your own kubernetes cluster used to be frustrating and difficult to inexperienced users. With the","title":"Home Cluster"},{"location":"cluster/#home-cluster","text":"Building and deploying your own kubernetes cluster used to be frustrating and difficult to inexperienced users. With the","title":"Home Cluster"},{"location":"cluster/getting-started/restoring-services/","text":"Restoring Services \u00b6 Bootstraping Flux \u00b6 Create or Locate Cluster GPG Key \u00b6 export GPG_TTY=$(tty) gpg --list-secret-keys Find your key fingerprint. export FLUX_KEY_FP=<YOUR FINGERPRINT> Verify cluster is ready for Flux \u00b6 flux --kubeconfig=./kubeconfig check --pre Pre-create the flux-system namespace \u00b6 kubectl --kubeconfig=./kubeconfig create namespace flux-system --dry-run=client -o yaml | kubectl --kubeconfig=./kubeconfig apply -f - Add the Age key in-order for Flux to decrypt sops secrets \u00b6 gpg --export-secret-keys --armor \"${FLUX_KEY_FP}\" | kubectl --kubeconfig=./kubeconfig create secret generic sops-gpg \\ --namespace=flux-system \\ --from-file=sops.asc=/dev/stdin Install Flux \u00b6 Due to race conditions with the Flux CRDs you will have to run the below command twice. There should be no errors on this second run. kubectl --kubeconfig=./kubeconfig apply --kustomize=./cluster/base/flux-system \ud83c\udf89 At this point after reconciliation Flux state should be restored. \ud83c\udf89","title":"Getting Started"},{"location":"cluster/getting-started/restoring-services/#restoring-services","text":"","title":"Restoring Services"},{"location":"cluster/getting-started/restoring-services/#bootstraping-flux","text":"","title":"Bootstraping Flux"},{"location":"cluster/getting-started/restoring-services/#create-or-locate-cluster-gpg-key","text":"export GPG_TTY=$(tty) gpg --list-secret-keys Find your key fingerprint. export FLUX_KEY_FP=<YOUR FINGERPRINT>","title":"Create or Locate Cluster GPG Key"},{"location":"cluster/getting-started/restoring-services/#verify-cluster-is-ready-for-flux","text":"flux --kubeconfig=./kubeconfig check --pre","title":"Verify cluster is ready for Flux"},{"location":"cluster/getting-started/restoring-services/#pre-create-the-flux-system-namespace","text":"kubectl --kubeconfig=./kubeconfig create namespace flux-system --dry-run=client -o yaml | kubectl --kubeconfig=./kubeconfig apply -f -","title":"Pre-create the flux-system namespace"},{"location":"cluster/getting-started/restoring-services/#add-the-age-key-in-order-for-flux-to-decrypt-sops-secrets","text":"gpg --export-secret-keys --armor \"${FLUX_KEY_FP}\" | kubectl --kubeconfig=./kubeconfig create secret generic sops-gpg \\ --namespace=flux-system \\ --from-file=sops.asc=/dev/stdin","title":"Add the Age key in-order for Flux to decrypt sops secrets"},{"location":"cluster/getting-started/restoring-services/#install-flux","text":"Due to race conditions with the Flux CRDs you will have to run the below command twice. There should be no errors on this second run. kubectl --kubeconfig=./kubeconfig apply --kustomize=./cluster/base/flux-system \ud83c\udf89 At this point after reconciliation Flux state should be restored. \ud83c\udf89","title":"Install Flux"},{"location":"hardware/airgradient/","text":"Air Gradient \u00b6 Some time ago, I saw Jeff Geerling's video about how your home's air could be making you sick. I decided I had to have one, but I couldn't source the parts. When he posted the video, it became almost impossible to source these parts overnight. I waited until airgradient started selling the kits and you could build them as an afternoon project. It took me roughly an hour and a half to put together with mediocre soldering skills. Following Geerling's Footsteps \u00b6 Flashing the airgradient was almost to easy. Install and launch the Arduino IDE . Select the board, install the required packages in the package manager. Connect the ESP using a cable that has all four strands of wire , because I tried to use one that had no data lines >:( Let's Improve It \u00b6 At the time, I already had grafana and a whole 'nother prometheus stack built into my home-cluster . I just needed a way to take the stats from the airgradient and shove them into promtheus. I hit up my friends at k8s@home and we spent the night working on migrating the entire library from relying on an external container to cache stats to letting prometheus access the device itself over the local network. See my pull request that I created on this. Apparently, Geerling liked it so much I got a shoutout :O This is the kind of thing that makes me so happy to develop with open source. I put something out there, someone takes it and makes it like 20x better with one PR: https://t.co/lnTw8ozk6c #opensource #thanks #payitforward \u2014 Jeff Geerling (@geerlingguy) September 14, 2021 Honestly, this was the highlight of my week. Okay, We Can Stop \u00b6 We even went a step further and, in an attempt to preserve commit history, created another fork called airgradient-prometheus-sensor with the hope of streamlineing the software for prometheus. It works exactly the same, but looks different.","title":"Air Gradient"},{"location":"hardware/airgradient/#air-gradient","text":"Some time ago, I saw Jeff Geerling's video about how your home's air could be making you sick. I decided I had to have one, but I couldn't source the parts. When he posted the video, it became almost impossible to source these parts overnight. I waited until airgradient started selling the kits and you could build them as an afternoon project. It took me roughly an hour and a half to put together with mediocre soldering skills.","title":"Air Gradient"},{"location":"hardware/airgradient/#following-geerlings-footsteps","text":"Flashing the airgradient was almost to easy. Install and launch the Arduino IDE . Select the board, install the required packages in the package manager. Connect the ESP using a cable that has all four strands of wire , because I tried to use one that had no data lines >:(","title":"Following Geerling's Footsteps"},{"location":"hardware/airgradient/#lets-improve-it","text":"At the time, I already had grafana and a whole 'nother prometheus stack built into my home-cluster . I just needed a way to take the stats from the airgradient and shove them into promtheus. I hit up my friends at k8s@home and we spent the night working on migrating the entire library from relying on an external container to cache stats to letting prometheus access the device itself over the local network. See my pull request that I created on this. Apparently, Geerling liked it so much I got a shoutout :O This is the kind of thing that makes me so happy to develop with open source. I put something out there, someone takes it and makes it like 20x better with one PR: https://t.co/lnTw8ozk6c #opensource #thanks #payitforward \u2014 Jeff Geerling (@geerlingguy) September 14, 2021 Honestly, this was the highlight of my week.","title":"Let's Improve It"},{"location":"hardware/airgradient/#okay-we-can-stop","text":"We even went a step further and, in an attempt to preserve commit history, created another fork called airgradient-prometheus-sensor with the hope of streamlineing the software for prometheus. It works exactly the same, but looks different.","title":"Okay, We Can Stop"},{"location":"hardware/codename-nezuko/","text":"Codename: Nezuko \u00b6 This custom built machine is named after a very popular character of the Demon Slayer: Kimetsu no Yaiba series. During the entire series of the show, Nezuko slowly turns into a demon, however maintains her elegance throughout. This is the inspiration I came up with to build this pc. Machine Specs \u00b6 AMD Ryzen 9 3900X AsRock Rack X470D4U MSI Ventus GeForce RTX 2060 Corsair RM650x LIAN LI LANCOOL II MESH Operating System \u00b6 As of writing this, Nezuko is running Proxmox 7.1-12 and is running 2 Ubuntu VM's acting as a k8s master and worker as well as a freepbx vm for my home phone system (although I will be migrating to Unifi Talk soon...) Storage \u00b6 I've populated both of the onboard NVME slots with Crucial P1 1TB M.2 NVMe SSD's. This motherboard however does not allocate the full bandwidth to utilize these drives.","title":"Codename: Nezuko"},{"location":"hardware/codename-nezuko/#codename-nezuko","text":"This custom built machine is named after a very popular character of the Demon Slayer: Kimetsu no Yaiba series. During the entire series of the show, Nezuko slowly turns into a demon, however maintains her elegance throughout. This is the inspiration I came up with to build this pc.","title":"Codename: Nezuko"},{"location":"hardware/codename-nezuko/#machine-specs","text":"AMD Ryzen 9 3900X AsRock Rack X470D4U MSI Ventus GeForce RTX 2060 Corsair RM650x LIAN LI LANCOOL II MESH","title":"Machine Specs"},{"location":"hardware/codename-nezuko/#operating-system","text":"As of writing this, Nezuko is running Proxmox 7.1-12 and is running 2 Ubuntu VM's acting as a k8s master and worker as well as a freepbx vm for my home phone system (although I will be migrating to Unifi Talk soon...)","title":"Operating System"},{"location":"hardware/codename-nezuko/#storage","text":"I've populated both of the onboard NVME slots with Crucial P1 1TB M.2 NVMe SSD's. This motherboard however does not allocate the full bandwidth to utilize these drives.","title":"Storage"},{"location":"hardware/synology/","text":"Synology DiskStation DS412+ \u00b6 A Child's Dream \u00b6 Released sometime in 2012, I bought the DS412+ with my parent's money. Originally as a christmas present to hold some of the projects and photos I took during my photography ambition, this nas has served me well into 2022 (10 years later!). Sometime in 2017, I upgraded this bad boy to use 4 gigabytes of DDR3 ram and eventually configured LACP on both of it's gigabit ports. Configuration \u00b6 I'm running DSM Version 6.2.4-25556 Update 5 with a single BTRFS Storage Pool. In this configuration, I expect to have 5.23 TB available running in a RAID 5 (with data protection) . Number Drive Size Type Model Drive 1 1.82 TB HDD ST2000DM008-2FR102 Drive 2 1.82 TB HDD ST2000DM008-2FR102 Drive 3 1.82 TB HDD ST2000DM008-2FR102 Drive 4 1.82 TB HDD ST2000DM008-2FR102 3-2-1 Backup \u00b6 AWS Glacier \u00b6 Using Synology's Glacier Backup application, I backup family documents and photos almost daily to AWS Glacier . I store around 1 TB of files and it costs $3.50 ($0.0036 per GB / Month) +/- related bandwidth fees. I don't expect to ever pull from the backup more than 1 or 2 times a year for testing. Google Storage \u00b6 Anything AWS Glacier doesn't pickup, gets shoved into my personal google storage. I currently simp for Google with my Pixel 6 Pro as my daily phone. I already previously paid for their Standard 200GB advertised on Google One , I simply upgraded to their Premium 2TB plan for $100/year. Every 3 days, using Synology's Cloud Sync , we push compressed zip's into my google drive only if the file's hash is modified. Local Storage \u00b6 This one is just incase I need to take the nas offline or need to take a copy of the nas with me to a family member's house. I use one of these Seagate 8TB Expansion EXT Drives which makes it really nice to take it anywhere. Problems For Future Me \u00b6 Recent Problems \u00b6 I have found Drive 2 to be constantly reporting bad sector counts quite too often, so I am currently researching to see if it is just an isolated case or just really bad QA on these model of drives. These drives are by no means meant to be running in this setup. Future Plans \u00b6 Following Level1Techs recent video, even though this uses software raid, I have decided that I am going to retire my Synology NAS to my grandparents as a off-site backup.","title":"Synology DiskStation DS412+"},{"location":"hardware/synology/#synology-diskstation-ds412","text":"","title":"Synology DiskStation DS412+"},{"location":"hardware/synology/#a-childs-dream","text":"Released sometime in 2012, I bought the DS412+ with my parent's money. Originally as a christmas present to hold some of the projects and photos I took during my photography ambition, this nas has served me well into 2022 (10 years later!). Sometime in 2017, I upgraded this bad boy to use 4 gigabytes of DDR3 ram and eventually configured LACP on both of it's gigabit ports.","title":"A Child's Dream"},{"location":"hardware/synology/#configuration","text":"I'm running DSM Version 6.2.4-25556 Update 5 with a single BTRFS Storage Pool. In this configuration, I expect to have 5.23 TB available running in a RAID 5 (with data protection) . Number Drive Size Type Model Drive 1 1.82 TB HDD ST2000DM008-2FR102 Drive 2 1.82 TB HDD ST2000DM008-2FR102 Drive 3 1.82 TB HDD ST2000DM008-2FR102 Drive 4 1.82 TB HDD ST2000DM008-2FR102","title":"Configuration"},{"location":"hardware/synology/#3-2-1-backup","text":"","title":"3-2-1 Backup"},{"location":"hardware/synology/#aws-glacier","text":"Using Synology's Glacier Backup application, I backup family documents and photos almost daily to AWS Glacier . I store around 1 TB of files and it costs $3.50 ($0.0036 per GB / Month) +/- related bandwidth fees. I don't expect to ever pull from the backup more than 1 or 2 times a year for testing.","title":"AWS Glacier"},{"location":"hardware/synology/#google-storage","text":"Anything AWS Glacier doesn't pickup, gets shoved into my personal google storage. I currently simp for Google with my Pixel 6 Pro as my daily phone. I already previously paid for their Standard 200GB advertised on Google One , I simply upgraded to their Premium 2TB plan for $100/year. Every 3 days, using Synology's Cloud Sync , we push compressed zip's into my google drive only if the file's hash is modified.","title":"Google Storage"},{"location":"hardware/synology/#local-storage","text":"This one is just incase I need to take the nas offline or need to take a copy of the nas with me to a family member's house. I use one of these Seagate 8TB Expansion EXT Drives which makes it really nice to take it anywhere.","title":"Local Storage"},{"location":"hardware/synology/#problems-for-future-me","text":"","title":"Problems For Future Me"},{"location":"hardware/synology/#recent-problems","text":"I have found Drive 2 to be constantly reporting bad sector counts quite too often, so I am currently researching to see if it is just an isolated case or just really bad QA on these model of drives. These drives are by no means meant to be running in this setup.","title":"Recent Problems"},{"location":"hardware/synology/#future-plans","text":"Following Level1Techs recent video, even though this uses software raid, I have decided that I am going to retire my Synology NAS to my grandparents as a off-site backup.","title":"Future Plans"},{"location":"hardware/zigbee-cordinator/","text":"Zigbee Coordinator \u00b6 My good friend Devin made the mistake of introducing me to this little piece of technology. This is a network attached device that coordinates your zigbee devices. It's got a cute management panel and it intergrates nicely with zigbee2mqtt which is running inside my cluster . It's super simple to learn how to add devices, but not as easy as updating them (its a whole 'nother world). Attached Devices \u00b6 Phillips Hue Motion Sensor","title":"Zigbee Coordinator"},{"location":"hardware/zigbee-cordinator/#zigbee-coordinator","text":"My good friend Devin made the mistake of introducing me to this little piece of technology. This is a network attached device that coordinates your zigbee devices. It's got a cute management panel and it intergrates nicely with zigbee2mqtt which is running inside my cluster . It's super simple to learn how to add devices, but not as easy as updating them (its a whole 'nother world).","title":"Zigbee Coordinator"},{"location":"hardware/zigbee-cordinator/#attached-devices","text":"Phillips Hue Motion Sensor","title":"Attached Devices"},{"location":"networking/bgp/","text":"","title":"BGP"},{"location":"networking/dns/","text":"Home DNS \u00b6 Internal DNS \u00b6 External DNS \u00b6 Dynamic DNS \u00b6","title":"DNS"},{"location":"networking/dns/#home-dns","text":"","title":"Home DNS"},{"location":"networking/dns/#internal-dns","text":"","title":"Internal DNS"},{"location":"networking/dns/#external-dns","text":"","title":"External DNS"},{"location":"networking/dns/#dynamic-dns","text":"","title":"Dynamic DNS"},{"location":"networking/general/","text":"","title":"General"},{"location":"networking/networks/","text":"Home Networks \u00b6 Management VLan \u00b6 Normal VLAN \u00b6 IOT VLAN \u00b6 Server VLAN \u00b6","title":"Networks"},{"location":"networking/networks/#home-networks","text":"","title":"Home Networks"},{"location":"networking/networks/#management-vlan","text":"","title":"Management VLan"},{"location":"networking/networks/#normal-vlan","text":"","title":"Normal VLAN"},{"location":"networking/networks/#iot-vlan","text":"","title":"IOT VLAN"},{"location":"networking/networks/#server-vlan","text":"","title":"Server VLAN"},{"location":"networking/router/","text":"","title":"Router"},{"location":"networking/switching/","text":"","title":"Switching"},{"location":"storage/lts/","text":"","title":"Long-term Storage"}]}